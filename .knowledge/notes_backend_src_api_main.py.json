{"is_source_file": true, "format": "Python", "description": "This file implements a RESTful API for a simple notes application using FastAPI and SQLite. It defines data models, database initialization, CRUD endpoints for notes, and configuration for CORS middleware. The file manages note data including creation, retrieval, updating, and deletion, with health check endpoint and environment-based configuration.", "external_files": ["sqlite3 (standard library)", "fastapi", "fastapi.middleware.cors", "pydantic", "os", "datetime"], "external_methods": ["FastAPI", "HTTPException", "Response", "CORSMiddleware", "BaseModel", "Field", "datetime.utcnow", "os.getenv", "os.path", "sqlite3.connect"], "published": ["app", "health_check"], "classes": [{"name": "Note", "description": "Data model representing a note with ID, title, content, creation and update timestamps."}, {"name": "NoteCreate", "description": "Model for payload used when creating a new note, requiring title and content."}, {"name": "NoteUpdate", "description": "Model for payload used when updating an existing note, supports partial updates of title and/or content."}], "methods": [{"name": "list[str] _parse_allowed_origins(raw: str)", "description": "Parses the ALLOWED_ORIGINS environment variable into a list of origin strings.", "scope": "", "scopeKind": ""}, {"name": "str _get_db_path()", "description": "Returns the file path to the SQLite database, defaulting to 'notes.db'.", "scope": "", "scopeKind": ""}, {"name": "sqlite3.Connection _get_conn()", "description": "Establishes a SQLite connection with row_factory for dict-like access.", "scope": "", "scopeKind": ""}, {"name": "None _init_db()", "description": "Initializes the database schema by creating the 'notes' table if it does not exist.", "scope": "", "scopeKind": ""}, {"name": "Note _row_to_note(row: sqlite3.Row)", "description": "Converts a SQLite row object into a Note model instance.", "scope": "", "scopeKind": ""}, {"name": "dict health_check()", "description": "A simple GET endpoint for health check, returning a 'Healthy' message.", "scope": "", "scopeKind": ""}, {"name": "List[Note] list_notes()", "description": "Retrieves and returns all notes ordered by last updated timestamp descending.", "scope": "", "scopeKind": ""}, {"name": "Note get_note(note_id: int)", "description": "Retrieves and returns a specific note by its ID; raises 404 if not found.", "scope": "", "scopeKind": ""}, {"name": "Note create_note(payload: NoteCreate)", "description": "Creates a new note with provided title and content, returns the created note.", "scope": "", "scopeKind": ""}, {"name": "Note update_note(note_id: int, payload: NoteUpdate)", "description": "Updates an existing note partially with new title/content; raises 404 if note not found.", "scope": "", "scopeKind": ""}, {"name": "Response delete_note(note_id: int)", "description": "Deletes a note by ID; raises 404 if note does not exist.", "scope": "", "scopeKind": ""}, {"name": "None _on_startup()", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["app.get", "app.post", "app.put", "app.delete", "_get_conn", "_init_db", "_row_to_note", "conn.execute", "conn.commit", "conn.close", "datetime.utcnow", "os.getenv"], "search-terms": ["notes_api", "FastAPI notes", "SQLite notes backend", "CRUD notes", "async API", "Python API SQLite", "notes REST endpoints"], "state": 2, "file_id": 2, "knowledge_revision": 10, "git_revision": "86af23efcb7a7b3c246fc0dd130743d98b2105a0", "revision_history": [{"9": "86af23efcb7a7b3c246fc0dd130743d98b2105a0"}, {"10": "86af23efcb7a7b3c246fc0dd130743d98b2105a0"}], "ctags": [{"_type": "tag", "name": "Note", "path": "/home/kavia/workspace/code-generation/simple-notes-application-304322-304331/notes_backend/src/api/main.py", "pattern": "/^class Note(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "NoteCreate", "path": "/home/kavia/workspace/code-generation/simple-notes-application-304322-304331/notes_backend/src/api/main.py", "pattern": "/^class NoteCreate(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "NoteUpdate", "path": "/home/kavia/workspace/code-generation/simple-notes-application-304322-304331/notes_backend/src/api/main.py", "pattern": "/^class NoteUpdate(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "_get_conn", "path": "/home/kavia/workspace/code-generation/simple-notes-application-304322-304331/notes_backend/src/api/main.py", "pattern": "/^def _get_conn() -> sqlite3.Connection:$/", "language": "Python", "typeref": "typename:sqlite3.Connection", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "_get_db_path", "path": "/home/kavia/workspace/code-generation/simple-notes-application-304322-304331/notes_backend/src/api/main.py", "pattern": "/^def _get_db_path() -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "_init_db", "path": "/home/kavia/workspace/code-generation/simple-notes-application-304322-304331/notes_backend/src/api/main.py", "pattern": "/^def _init_db() -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "_on_startup", "path": "/home/kavia/workspace/code-generation/simple-notes-application-304322-304331/notes_backend/src/api/main.py", "pattern": "/^def _on_startup() -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "_parse_allowed_origins", "path": "/home/kavia/workspace/code-generation/simple-notes-application-304322-304331/notes_backend/src/api/main.py", "pattern": "/^def _parse_allowed_origins(raw: str) -> list[str]:$/", "language": "Python", "typeref": "typename:list[str]", "kind": "function", "signature": "(raw: str)"}, {"_type": "tag", "name": "_row_to_note", "path": "/home/kavia/workspace/code-generation/simple-notes-application-304322-304331/notes_backend/src/api/main.py", "pattern": "/^def _row_to_note(row: sqlite3.Row) -> Note:$/", "language": "Python", "typeref": "typename:Note", "kind": "function", "signature": "(row: sqlite3.Row)"}, {"_type": "tag", "name": "allow_headers", "path": "/home/kavia/workspace/code-generation/simple-notes-application-304322-304331/notes_backend/src/api/main.py", "pattern": "/^allow_headers = [h.strip() for h in os.getenv(\"ALLOWED_HEADERS\", \"*\").split(\",\")] if os.getenv(\"/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "allow_methods", "path": "/home/kavia/workspace/code-generation/simple-notes-application-304322-304331/notes_backend/src/api/main.py", "pattern": "/^allow_methods = [m.strip() for m in os.getenv(\"ALLOWED_METHODS\", \"*\").split(\",\")] if os.getenv(\"/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "allowed_origins", "path": "/home/kavia/workspace/code-generation/simple-notes-application-304322-304331/notes_backend/src/api/main.py", "pattern": "/^allowed_origins = _parse_allowed_origins(os.getenv(\"ALLOWED_ORIGINS\", \"\"))$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "app", "path": "/home/kavia/workspace/code-generation/simple-notes-application-304322-304331/notes_backend/src/api/main.py", "pattern": "/^app = FastAPI($/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "content", "path": "/home/kavia/workspace/code-generation/simple-notes-application-304322-304331/notes_backend/src/api/main.py", "pattern": "/^    content: Optional[str] = Field(None, description=\"Updated note content\\/body.\")$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "NoteUpdate", "scopeKind": "class"}, {"_type": "tag", "name": "content", "path": "/home/kavia/workspace/code-generation/simple-notes-application-304322-304331/notes_backend/src/api/main.py", "pattern": "/^    content: str = Field(..., description=\"Note content\\/body.\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "Note", "scopeKind": "class"}, {"_type": "tag", "name": "content", "path": "/home/kavia/workspace/code-generation/simple-notes-application-304322-304331/notes_backend/src/api/main.py", "pattern": "/^    content: str = Field(..., description=\"Note content\\/body.\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "NoteCreate", "scopeKind": "class"}, {"_type": "tag", "name": "create_note", "path": "/home/kavia/workspace/code-generation/simple-notes-application-304322-304331/notes_backend/src/api/main.py", "pattern": "/^def create_note(payload: NoteCreate) -> Note:$/", "language": "Python", "typeref": "typename:Note", "kind": "function", "signature": "(payload: NoteCreate)"}, {"_type": "tag", "name": "created_at", "path": "/home/kavia/workspace/code-generation/simple-notes-application-304322-304331/notes_backend/src/api/main.py", "pattern": "/^    created_at: datetime = Field(..., description=\"Creation timestamp (UTC).\")$/", "language": "Python", "typeref": "typename:datetime", "kind": "variable", "scope": "Note", "scopeKind": "class"}, {"_type": "tag", "name": "delete_note", "path": "/home/kavia/workspace/code-generation/simple-notes-application-304322-304331/notes_backend/src/api/main.py", "pattern": "/^def delete_note(note_id: int) -> Response:$/", "language": "Python", "typeref": "typename:Response", "kind": "function", "signature": "(note_id: int)"}, {"_type": "tag", "name": "get_note", "path": "/home/kavia/workspace/code-generation/simple-notes-application-304322-304331/notes_backend/src/api/main.py", "pattern": "/^def get_note(note_id: int) -> Note:$/", "language": "Python", "typeref": "typename:Note", "kind": "function", "signature": "(note_id: int)"}, {"_type": "tag", "name": "health_check", "path": "/home/kavia/workspace/code-generation/simple-notes-application-304322-304331/notes_backend/src/api/main.py", "pattern": "/^def health_check() -> dict:$/", "language": "Python", "typeref": "typename:dict", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "id", "path": "/home/kavia/workspace/code-generation/simple-notes-application-304322-304331/notes_backend/src/api/main.py", "pattern": "/^    id: int = Field(..., description=\"Unique note identifier.\")$/", "language": "Python", "typeref": "typename:int", "kind": "variable", "scope": "Note", "scopeKind": "class"}, {"_type": "tag", "name": "list_notes", "path": "/home/kavia/workspace/code-generation/simple-notes-application-304322-304331/notes_backend/src/api/main.py", "pattern": "/^def list_notes() -> List[Note]:$/", "language": "Python", "typeref": "typename:List[Note]", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "openapi_tags", "path": "/home/kavia/workspace/code-generation/simple-notes-application-304322-304331/notes_backend/src/api/main.py", "pattern": "/^openapi_tags = [$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "title", "path": "/home/kavia/workspace/code-generation/simple-notes-application-304322-304331/notes_backend/src/api/main.py", "pattern": "/^    title: Optional[str] = Field(None, min_length=1, max_length=200, description=\"Updated note t/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "NoteUpdate", "scopeKind": "class"}, {"_type": "tag", "name": "title", "path": "/home/kavia/workspace/code-generation/simple-notes-application-304322-304331/notes_backend/src/api/main.py", "pattern": "/^    title: str = Field(..., description=\"Note title.\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "Note", "scopeKind": "class"}, {"_type": "tag", "name": "title", "path": "/home/kavia/workspace/code-generation/simple-notes-application-304322-304331/notes_backend/src/api/main.py", "pattern": "/^    title: str = Field(..., min_length=1, max_length=200, description=\"Note title.\")$/", "language": "Python", "typeref": "typename:str", "kind": "variable", "scope": "NoteCreate", "scopeKind": "class"}, {"_type": "tag", "name": "update_note", "path": "/home/kavia/workspace/code-generation/simple-notes-application-304322-304331/notes_backend/src/api/main.py", "pattern": "/^def update_note(note_id: int, payload: NoteUpdate) -> Note:$/", "language": "Python", "typeref": "typename:Note", "kind": "function", "signature": "(note_id: int, payload: NoteUpdate)"}, {"_type": "tag", "name": "updated_at", "path": "/home/kavia/workspace/code-generation/simple-notes-application-304322-304331/notes_backend/src/api/main.py", "pattern": "/^    updated_at: datetime = Field(..., description=\"Last update timestamp (UTC).\")$/", "language": "Python", "typeref": "typename:datetime", "kind": "variable", "scope": "Note", "scopeKind": "class"}], "hash": "b0ada54ff6ca3827d3c4ce7cc9c9b5fc", "format-version": 4, "code-base-name": "notes_backend", "filename": "notes_backend/src/api/main.py", "fields": [{"name": "allow_headers = [h.strip() for h in os.getenv(\"ALLOWED_HEADERS\", \"*\").split(\",\")] if os.getenv(\"/", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "allow_methods = [m.strip() for m in os.getenv(\"ALLOWED_METHODS\", \"*\").split(\",\")] if os.getenv(\"/", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "allowed_origins = _parse_allowed_origins(os.getenv(\"ALLOWED_ORIGINS\", \"\"))", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "app = FastAPI(", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Optional[str] content", "scope": "NoteUpdate", "scopeKind": "class", "description": "unavailable"}, {"name": "str content", "scope": "Note", "scopeKind": "class", "description": "unavailable"}, {"name": "datetime created_at", "scope": "Note", "scopeKind": "class", "description": "unavailable"}, {"name": "int id", "scope": "Note", "scopeKind": "class", "description": "unavailable"}, {"name": "openapi_tags = [", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Optional[str] title", "scope": "NoteUpdate", "scopeKind": "class", "description": "unavailable"}, {"name": "str title", "scope": "Note", "scopeKind": "class", "description": "unavailable"}, {"name": "datetime updated_at", "scope": "Note", "scopeKind": "class", "description": "unavailable"}]}